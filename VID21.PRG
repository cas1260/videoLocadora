*****************************************
*		 CADASTRO DE CLIENTE VID21.PRG    *
*****************************************
SAVE SCREEN TO VTELA_VID21
DO WHILE .T.
	IF VCLIENTE = "N"
		NAO()
		EXIT
	ENDIF
	USE CLIENTE INDEX CLIENTEA INDEX CLIENTEB
	SEEK "KAGHSKFHKAFKDAKFAKFB;KAKJAGHFG;FAGFGSD"
	VCODIGO= SPACE(5)
*	@ 06,00 TO 24,78 DOUBLE
	@ 05,01 CLEAR TO 23,77
	VNOME=NOME
	VENDERECO=ENDERECO
	VBAIRRO=BAIRRO
	VTEL=TELEFONE 
	VCPF=CPF
	VRG=RG
	VCIDADE=CIDADE
	VDEP1=DEP1
	VDEP2=DEP2
	VTRABALHO=TRABALHO 
	VDTNASCI=DTNASCI
	VDATA=DATA
	VREF1=REF1
	VREF2=REF2
	VPROB=PROBLEMA
	VOBS=SPACE(1)
	VTEX1=OBSERVACAO
   VMAE=MAE
	VPAI=PAI
	VCODIGO = SPACE(6)
	CENTRA(06,01,78,"[ F2 - PESQUISAR ]")
   @ 07,01 SAY "Codigo: " GET VCODIGO PICT "999999"
	@ 07,17 SAY "NOME:"GET VNOME PICTURE "@!"
*	@ 07,60 SAY "CODIGO:" GET VCODIGO PICTURE "999999"
	@ 09,03 SAY "ENDERECO:"GET VENDERECO PICTURE "@!"
	@ 09,60 SAY "DTN:"GET VDTNASCI	
	@ 11,03 SAY "BAIRRO:"GET VBAIRRO PICTURE "@!"
	@ 11,38 SAY "CIDADE:"GET VCIDADE PICTURE "@!"
	@ 13,03 SAY "TEL.:"GET VTEL PICT "9999-9999"
	@ 13,20 SAY "RG.:"GET VRG
	@ 13,40 SAY "CPF:"GET VCPF PICT "999.999.999.99"
	@ 13,60 SAY "DATA:" GET VDATA		
	@ 15,03 SAY "DEPENDENTE 1: "GET VDEP1 PICTURE "@!" 
	@ 16,03 SAY "DEPENDENTE 2: "GET VDEP2 PICTURE "@!" 	
   @ 17,03 SAY "MAE           " GET VMAE PICT "@!"
   @ 18,03 SAY "PAI           " GET VPAI PICT "@!"
	@ 19,03 SAY "REFERENCIA 1: "GET VREF1 PICTURE "@!"
	@ 20,03 SAY "REFERENCIA 2: "GET VREF2 PICTURE "@!"	
	@ 20,59 SAY "PROBLEMA (S/N):" GET VPROB PICTURE "!" VALID VPROB$"SN"
	@ 21,03 SAY "ONDE TRABALHA:"GET VTRABALHO PICTURE "@!"
	@ 21,59 SAY "OBSERVACAO (S/N):" GET VOBS PICTURE "!" VALID VOBS$"SN "
	CLEAR GETS
	SET KEY -1 TO E
   @ 07,01 SAY "Codigo: " GET VCODIGO PICT "999999"
	READ
	SET KEY -1 TO
	IF LASTKEY() = 27
		EXIT
	ENDIF
	IF VCODIGO = SPACE(6)
		BOX("Procurando Registro em Braco !!!")
		X=1
		USE CLIENTE INDEX CLIENTEA INDEX CLIENTEB
		GO TOP
		DO WHILE .NOT. EOF()
	   	VCODIGO=STRZERO(X,6)
	   	SEEK VCODIGO
			X = X + 1
*			SKIP
		ENDDO
	ENDIF
	VSIM_NAO = .T.
	USE CLIENTE INDEX CLIENTEA INDEX CLIENTEB
	VCODIGO= STRZERO(VAL(VCODIGO),6)
	SEEK VCODIGO
	IF EOF()
		VSIM_NAO = .F.
		VNOME=NOME
		VENDERECO=ENDERECO
		VBAIRRO=BAIRRO
		VTEL=TELEFONE 
		VCPF=CPF
		VRG=RG
		VCIDADE=CIDADE
		VDEP1=DEP1
		VDEP2=DEP2
		VTRABALHO=TRABALHO 
		VDTNASCI=DTNASCI
		VDATA=DATA
		VREF1=REF1
		VREF2=REF2
		VPROB=PROBLEMA
		VOBS=SPACE(1)
		VTEX1=OBSERVACAO
      VMAE=MAE
		VPAI=PAI
	ELSE
		VSIM_NAO = .T.
		VNOME=NOME
		VENDERECO=ENDERECO
		VBAIRRO=BAIRRO
		VTEL=TELEFONE 
		VCPF=CPF
		VRG=RG
		VCIDADE=CIDADE
		VDEP1=DEP1
		VDEP2=DEP2
		VTRABALHO=TRABALHO 
		VDTNASCI=DTNASCI
		VDATA=DATA
		VREF1=REF1
		VREF2=REF2
		VPROB=PROBLEMA
		VOBS=SPACE(1)
		VTEX1=OBSERVACAO
	   VMAE=MAE
		VPAI=PAI
	ENDIF
	@ 06,01 CLEAR TO 23,77
*	SETCURSOR(2)
	@ 07,01 SAY "Codigo:  " + VCODIGO 
	@ 07,17 SAY "NOME:"GET VNOME PICTURE "@!"
	@ 09,03 SAY "ENDERECO:"GET VENDERECO PICTURE "@!"
	@ 09,60 SAY "DTN:"GET VDTNASCI	
	@ 11,03 SAY "BAIRRO:"GET VBAIRRO PICTURE "@!"
	@ 11,38 SAY "CIDADE:"GET VCIDADE PICTURE "@!"
	@ 13,03 SAY "TEL.:"GET VTEL PICT "9999-9999"
	@ 13,20 SAY "RG.:"GET VRG
	@ 13,40 SAY "CPF:"GET VCPF PICT "999.999.999.99"
	@ 13,60 SAY "DATA:" GET VDATA		
	@ 15,03 SAY "DEPENDENTE 1: "GET VDEP1 PICTURE "@!" 
	@ 16,03 SAY "DEPENDENTE 2: "GET VDEP2 PICTURE "@!" 	
   @ 17,03 SAY "MAE           " GET VMAE PICT "@!"
   @ 18,03 SAY "PAI           " GET VPAI PICT "@!"
	@ 19,03 SAY "REFERENCIA 1: "GET VREF1 PICTURE "@!"
	@ 20,03 SAY "REFERENCIA 2: "GET VREF2 PICTURE "@!"	
*	@ 20,59 SAY "PROBLEMA (S/N):" GET VPROB PICTURE "!" VALID VPROB$"SN"
	@ 21,03 SAY "ONDE TRABALHA:"GET VTRABALHO PICTURE "@!"
	VOBS = VPROB
	@ 21,59 SAY "OBSERVACAO (S/N):" GET VOBS PICTURE "!" VALID VOBS$"SN "
	READ
	VPROB = VOBS
	IF LASTKEY()#27
	   IF VOBS="S"
		   SAVE SCREEN TO VTELAX
         @ 13,06 TO 20,77
         @ 13,08 SAY "[ RESUMO DO CONTRATO: [Ctrl + W Salvar ]"
         @ 14,07 CLEAR TO 19,76
*         SETCURSOR(2) 
		   VCURS=.T.
	 	   VTEX1=MEMOEDIT(VTEX1,14,8,19,75,.T.)
         RESTORE SCREEN FROM VTELAX
		ENDIF
		IF LASTKEY()#27
			IF VSIM_NAO = .F.
				APPEND BLANK
			ENDIF
			REPLACE NOME WITH VNOME 
			REPLACE ENDERECO WITH VENDERECO 
			REPLACE BAIRRO WITH VBAIRRO 
			REPLACE CIDADE WITH VCIDADE
			REPLACE TELEFONE WITH VTEL 
			REPLACE CPF WITH VCPF 
			REPLACE RG WITH VRG 
			REPLACE DEP1 WITH VDEP1
			REPLACE DEP2 WITH VDEP2
			REPLACE TRABALHO WITH VTRABALHO 
			REPLACE DATA WITH VDATA 
			REPLACE DTNASCI WITH VDTNASCI
			REPLACE PROBLEMA WITH VPROB
         REPLACE MAE WITH VMAE 
			REPLACE PAI WITH VPAI
			REPLACE CODIGO WITH VCODIGO 
			REPLACE CODCLI WITH VCODIGO
	      REPLACE OBSERVACAO WITH VTEX1
			REPLACE REF1 WITH VREF1
			REPLACE REF2 WITH VREF2			
		ENDIF
	ENDIF
ENDDO
CLOSE ALL
RESTORE SCREEN FROM VTELA_VID21
RETURN