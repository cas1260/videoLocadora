****************************************
* VID3C.PRG CALCULARA TOTAL DE PRODUTO	*
****************************************
SAVE SCREEN TO VTELA_CAL
DO WHILE .T.
	@ 05,01 CLEAR TO 23,77
	VCHAVE = SPACE(5)
	@ 10,10 SAY "Codigo do Produto " GET VCHAVE PICT "99999"
	READ
	IF LASTKEY() = 27
		EXIT
	ENDIF
	IF VCHAVE = SPACE(5)
		VCHAVE = SHOW()
	ENDIF
	VCHAVE = STRZERO(VAL(VCHAVE),5)
	USE PRODUTO INDEX PRODUTOA INDEX PRODUTOB
	SEEK VCHAVE
	IF EOF()
		MSGBOX("Produto n∆o Encontrado!")
		LOOP
	ENDIF
	@ 05,01 CLEAR TO 23,77
	@ 08,20 SAY "DESCRICAO:" + DESCRICAO 
	@ 08,03 SAY "CODIGO: " + CODPROD
	@ 10,03 SAY "ATORES:" + ATORES 
	VCLASSE = CLASSE
	@ 12,03 SAY "CLASSE:" + CLASSE
	@ 14,03 SAY "TIPO:" +  TIPO 
	@ 16,03 SAY "DUBLADO.:" + DUBLADO
	B_TIPO(STRZERO(VAL(TIPO),2))
	B_CLASSE(STRZERO(VAL(VCLASSE),2))
	USE LOCACAO2
	GO TOP
	VVALOR = 0
	DO WHILE !EOF()
		IF VCHAVE = PRODUTO
			VVALOR = VVALOR + VALOR
		ENDIF
		SKIP
	ENDDO
	@ 18,03 SAY "Valor Total:  " + STR(VVALOR)
	INKEY(0)
ENDDO
RESTORE SCREEN FROM VTELA_CAL
RETURN