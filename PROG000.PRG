FUNCTION BoxMenu
	PARAMETERS VCONTOP,VOPCOES,VMSG,VLIN,VCOL,VLIMPA
	PRIVATE VOPCAO,VLINM
   VLINM = IIF(VLIN+VCONTOP<24,VLIN+VCONTOP,VLIMPA)
   @ VLIN,VCOL TO VLINM+1,VCOL+VLIMPA+1
	KEYBOARD CHR(31)
   VOPCAO = ACHOICE (VLIN+1,VCOL+1,VLINM,VCOL+VLIMPA,VOPCOES,.T.,"OPMSG")
	RETURN VOPCAO

*** fim da funcao SUBMENU

FUNCTION OPMSG											&& mensagem p/ menu pop-up

	PARAMETERS VMODO,VPOS,VTECLA
	PRIVATE VRESP
	VKEY = 1
*	@ 23,01 SAY SPACE(77)
	@ 24,01 TO 24,77 DOUBLE
	IF VMSG[VPOS] = ""
		CENTRA(24,00,80,"[ " + VMSG[VPOS] + " ]")
	ELSE

	ENDIF
	DO CASE
		CASE VMODO = 1
			VRESP = 2
			KEYBOARD CHR(30)

		CASE VMODO = 2
			VRESP = 2
			KEYBOARD CHR(31)
				
		CASE VMODO = 3
			DO CASE
				CASE LASTKEY() = 13
					VRESP = 1
			
				CASE LASTKEY() = 27
					VRESP = 0
			
				CASE LASTKEY() = 1
					VRESP = 2
					KEYBOARD CHR(31)
				CASE LASTKEY() = 6
               VRESP = 2
               KEYBOARD CHR(30)
           CASE LASTKEY() = 19 
					VRESP = 0
					KEYBOARD CHR(LASTKEY())
			  CASE LASTKEY() = 4
					VRESP = 0
					KEYBOARD CHR(LASTKEY())

				CASE ASCAN(VOPCOES,CHR(LASTKEY())) # 0
					VRESP = 3
					KEYBOARD CHR(13)
				OTHERWISE
					VRESP = 2

			ENDCASE
		OTHERWISE
			VRESP = 2
				
	ENDCASE
	
	RETURN VRESP

*** fim da funcao OPMSG

FUNCTION CENTRA										&& centraliza uma mensagem

	PARAMETERS VLIN,VINI,VFIM,VPAL

	PRIVATE VPOS
   IF LEN(VPAL) > VFIM-VINI+1   
               VPOS = VINI
       ELSE
               VPOS = VINI+INT(((VFIM-VINI+1)-LEN(VPAL))/2)
       ENDIF

       @ VLIN,VPOS SAY VPAL

       RETURN VPOS

*** fim da funcao CENTRA
FUNCTION MSGBOX
	PARAMETERS VMSG1							&& apresenta mensagem de advertencia
	SAVE SCREEN TO VTELA_MSG_BOX
	SET CURSO OFF

	PRIVATE VCOLOR1,VCOLOR2,VPOS,VRESP,VLOOP

	CLEAR TYPEAHEAD
	
	VRESP = " "
	VCOLOR1 = SETCOLOR()

	@ 11, 6 TO 13,73 DOUBLE
	SET COLOR TO &VCTITU
	@ 12,7 SAY SPACE(66)
	VPOS = CENTRA(12,7,72,VMSG1)
	INKEY(0)
	SETCOLOR(VCOLOR1)
	SET CURSO ON
	RESTORE SCREEN FROM VTELA_MSG_BOX

RETURN VRESP
	
*** fim da funcao MSGBOX

FUNCTION BOX
	PARAMETERS VMSG1							&& apresenta mensagem de advertencia

	SET CURSO OFF

	PRIVATE VCOLOR1,VCOLOR2,VPOS,VRESP,VLOOP

	CLEAR TYPEAHEAD
	
	VRESP = " "
	VCOLOR1 = SETCOLOR()

	@ 11, 6 TO 13,73 DOUBLE
	SET COLOR TO &VCTITU
	@ 12,7 SAY SPACE(66)
	VPOS = CENTRA(12,7,72,VMSG1)
	SETCOLOR(VCOLOR1)
	SET CURSO ON

RETURN VRESP
	
*** fim da funcao BOX

FUNCTION DIASEM										&& dia da semana em portugues

       PARAMETERS VDATA

       PRIVATE VSEMANA,VDIASEM

       IF TYPE("VDATA")#"D"
               VDIASEM = " "
       ELSE
					VSEMANA = "1Domingo2Segunda3Ter‡a  4Quarta 5Quinta 6Sexta  7Sabado "
					VDIASEM = SUBSTR(VSEMANA,AT(STR(DOW(VDATA),1),VSEMANA)+1,7)
       ENDIF

	RETURN TRIM(VDIASEM)

*** fim da funcao DIASEM
******************
FUNCTION SHOW_C
******************
SAVE SCREEN TO VTELA_1
PRIVATE VCAMPOS[5],VCAB[5]
	VC_CORES = SETCOLOR()
	VKEY = ""
	KEYBOARD CHR(1)
	USE CLIENTE INDEX CLIENTEB INDEX CLIENTEA
	VCAMPOS[1] = "NOME"
	VCAMPOS[2] = "CODIGO"
	VCAMPOS[3] = "TELEFONE" 
	VCAMPOS[4] = "DEP1"
	VCAMPOS[5] = "DEP2"

	VCAB[1] = "Nome"
	VCAB[2] = "Codigo"
	VCAB[3] = "Telefone"
	VCAB[4] = "Dependete 1"
	VCAB[5] = "Dependete 1"

	@ 04,10 CLEAR TO 16,75
	@ 04,10 TO 17,76 DOUBLE
	VCORES = SETCOLOR()
	@ 06,11 TO 06,75 DOUBLE
	SET COLOR TO N/W
		@ 05,11 SAY SPACE(65)
		@ 05,11 SAY UPPER(VKEY)
	SET COLOR TO N*/W
		@ 05,11+LEN(VKEY) SAY "Ü"
	SET COLOR TO W+/RB,N/W
	CENTRA(04,10,75,'[ Tecle "DELETE" Para Excluir ]') 
	CENTRA(17,10,75,"[ Pesquisa de Cliente ]")
	DBEDIT(7,11,16,75,VCAMPOS,"BUSCA_C",0,VCAB)
	SET COLOR TO &VCORES
	SET CURSO ON
RESTORE SCREEN FROM VTELA_1
IF LASTKEY() = 27
	CODIGOT = SPACE(6)
ENDIF
SET COLOR TO &VC_CORES
RETURN CODIGOT
FUNCTION E
	VCS= SETCOLOR()
	VKEY = ""
	VCODIGO = SHOW_C()
	SET COLOR TO &VCS
RETURN VCODIGO
FUNCTION BUSCA_C						&& pula para letra

	PARAMETERS VMODO,VCAMPO
*	PRIVATE VRET
*	V_	
	IF VMODO=4 &&AND. LASTKEY()>31 .AND. LASTKEY()<128 .OR. LASTKEY()=8 
		IF LASTKEY()>31 .AND. LASTKEY()<128 .OR. LASTKEY()=8 	
			TECLA = LASTKEY()
			IF TECLA = 8 .OR. TECLA = 19
				VKEY = LEFT(VKEY,LEN(VKEY)-1)
			ELSE
				VKEY = VKEY + CHR(TECLA)
			ENDIF
			SET SOFTSEEK ON
			SEEK UPPER(VKEY)
			SET SOFTSEEK OFF
			SET COLOR TO N/W
				@ 05,11 SAY SPACE(65)
				@ 05,11 SAY UPPER(VKEY)
			SET COLOR TO N*/W
				@ 05,11+LEN(VKEY) SAY "Ü"
			SET COLOR TO W+/RB,N/W
			VRET = 2
		ELSE
		IF  LASTKEY()=13 .OR. LASTKEY()=27
				VRET = 0
				VKEY = CODCLI 
			ELSE
				VRET = 1
			ENDIF		
		ENDIF
	ELSE
	  IF  LASTKEY()=13 .OR. LASTKEY()=27
			VRET = 0
			VKEY = CODCLI
		ELSE
			VRET = 1
		ENDIF
		
	ENDIF
	IF LASTKEY() = 5 .OR. LASTKEY() = 24
		VKEY = ALLTRIM(NOME)
		SET COLOR TO N/W
			@ 05,11 SAY SPACE(65)
			@ 05,11 SAY UPPER(VKEY)
		SET COLOR TO N*/W
			@ 05,11+LEN(VKEY) SAY "Ü"
		SET COLOR TO W+/RB,N/W
	ENDIF
	IF LASTKEY() = 19
		VKEY = ""
		SET COLOR TO N/W
			@ 05,11 SAY SPACE(65)
			@ 05,11 SAY UPPER(VKEY)
		SET COLOR TO N*/W
			@ 05,11+LEN(VKEY) SAY "Ü"
		SET COLOR TO W+/RB,N/W
	ENDIF
	IF LASTKEY() = 7
		@ 12,40 CLEAR TO 15,65
		@ 12,40 TO 15,65
		CENTRA(13,40,65,"Deseja Excluir?")
		@ 14,45 PROMPT " SIM "
		@ 14,53 PROMPT " NAO "
		MENU TO VOP
		DO CASE 
			CASE VOP=1
				DELE
				SKIP-1
				SET CURSO OFF
		ENDCASE
		KEYBOARD CHR(1)
		VRET = 2
	ENDIF
	CODIGOT = CODCLI

	RETURN VRET
**********************
FUNCTION MOSTRATIPO 
**********************
SAVE SCREEN TO VTELA_TIP
PRIVATE VCAMPOS[4],VCAB[4]
	SET KEY -1 TO
	VKEY = ""
	KEYBOARD CHR(1)
	USE TIPO INDEX TIPOA
	VCAMPOS[1] = "NOMETIPO"
	VCAMPOS[2] = "CODTIPO"
	VCAMPOS[3] = "VALORTIPO" 

	VCAB[1] = "Nome"
	VCAB[2] = "Codigo"
	VCAB[3] = "Valor"

	@ 06,10 CLEAR TO 16,75
	@ 06,10 TO 17,76 DOUBLE

*	@ 06,11 TO 06,75 DOUBLE
	CENTRA(06,10,75,'[ Tecle "DELETE" Para Excluir ]') 
	CENTRA(17,10,75,"[ Pesquisa de Tipo ]")
	DBEDIT(7,11,16,75,VCAMPOS,"BUSCA_T",0,VCAB)
	IF LASTKEY()#27
		VCODTIPO = CODTIPO
*		KEYBOARD CHR(13)
	ELSE
		VCODTIPO = "  "
	ENDIF				
	CLOSE DATABASE
	SET CURSO ON
SET KEY -1 TO MOSTRATIPO
RESTORE SCREEN FROM VTELA_TIP
RETURN VCODTIPO
FUNCTION BUSCA_T						&& pula para letra

	PARAMETERS VMODO,VCAMPO
*	PRIVATE VRET
	IF LASTKEY() = 7
		@ 12,40 CLEAR TO 15,65
		@ 12,40 TO 15,65
		CENTRA(13,40,65,"Deseja Excluir?")
		@ 14,45 PROMPT " SIM "
		@ 14,53 PROMPT " NAO "
		MENU TO VOP
		DO CASE 
			CASE VOP=1
				DELE
				SKIP-1
				SET CURSO OFF
			ENDCASE
		KEYBOARD CHR(1)
		VRET = 2	
	ELSE
		IF  LASTKEY()=13 .OR. LASTKEY()=27
			VRET = 0
		ELSE
			VRET = 1
		ENDIF		
	ENDIF
RETURN VRET

PROCEDURE DEL_REG
IF LASTKEY() = 7
	@ 12,40 CLEAR TO 15,65
	@ 12,40 TO 15,65
	CENTRA(13,40,65,"Deseja Excluir?")
	@ 14,45 PROMPT " SIM "
	@ 14,53 PROMPT " NAO "
	MENU TO VOP
	DO CASE 
		CASE VOP=1
			DELE
			SKIP-1
			SET CURSO OFF
		ENDCASE
	KEYBOARD CHR(1)
	VRET = 2	
ENDIF
**********************
FUNCTION MOSTRACLASSE
**********************
SAVE SCREEN TO VTELA_TIP
PRIVATE VCAMPOS[2],VCAB[2]
	SET KEY -1 TO
	USE CLASSE INDEX CLASSEA
	KEYBOARD CHR(1)

	VCAMPOS[1] = "NOMECLAS"
	VCAMPOS[2] = "CODCLAS"

	VCAB[1] = "Nome"
	VCAB[2] = "Codigo"

	@ 06,10 CLEAR TO 16,75
	@ 06,10 TO 17,76 DOUBLE

	CENTRA(06,10,75,'[ Tecle "DELETE" Para Excluir ]') 
	CENTRA(17,10,75,"[ Pesquisa de Classe ]")
	DBEDIT(7,11,16,75,VCAMPOS,"BUSCA_T",0,VCAB)
	IF LASTKEY()#27
		VCODCLAS = CODCLAS
*		KEYBOARD CHR(13)
	ENDIF				
	SET CURSO ON
SET KEY -1 TO MOSTRACLASSE
RESTORE SCREEN FROM VTELA_TIP
RETURN CODCLAS
************
FUNCTION PAS
************
PARAMETERS VLIN,VCOL,VSPACE
SAVE SCREEN TO VTELA_PAS
*PUBLIC VSENHA
VSENHA = ""
VCORES = SETCOLOR()
DO WHILE .T.
	SET COLOR TO I/W
	@ VLIN,VCOL SAY SPACE(VSPACE)
	@ VLIN,VCOL SAY REPLICATE(CHR(4),LEN(VSENHA))
*	@ VLIN,VCOL+LEN(VSENHA) SAY ""
	SET COLOR TO &VCORES
	A = INKEY(0)
	IF LASTKEY()>31 .AND. LASTKEY()<128
		IF LEN(VSENHA)<VSPACE
			VSENHA = VSENHA + CHR(A)
		ENDIF
	ENDIF
	IF LASTKEY() = 8 .OR. LASTKEY()=19
		VSENHA = LEFT(VSENHA,LEN(VSENHA)-1)
	ENDIF
	IF LASTKEY()=27 .OR. LASTKEY()=13
		EXIT 
	ENDIF
ENDDO
RESTORE SCREEN FROM VTELA_PAS
RETURN VSENHA
***********************
PROCEDURE MOSTRAUSUARIO
***********************
SAVE SCREEN TO VTELA_USUARIO
PRIVATE VCAMPOS[2],VCAB[2]
	KEYBOARD CHR(1)
	USE USUARIO

	VCAMPOS[1] = "NOME_U"
	VCAMPOS[2] = "COD_U"

	VCAB[1] = "Nome"
	VCAB[2] = "Codigo"

	@ 12,35 CLEAR TO 20,75
	@ 12,35 TO 20,75 DOUBLE

	CENTRA(12,35,75,'[ Tecle "DELETE" Para Excluir ]') 
	CENTRA(20,36,74,"[ Pesquisa de Usuario ]")
	DBEDIT(13,36,19,74,VCAMPOS,"BUSCA_U",0,VCAB)
	IF LASTKEY() # 27
		VCOD = COD_U
*		KEYBOARD CHR(13)
	ENDIF
	SET CURSO ON
RESTORE SCREEN FROM VTELA_USUARIO
RETURN
FUNCTION BUSCA_U						&& pula para letra

	PARAMETERS VMODO,VCAMPO
	IF LASTKEY() = 7
		SAVE SCREEN TO VTELA_DEL
		@ 12,40 CLEAR TO 15,65
		@ 12,40 TO 15,65
		CENTRA(13,40,65,"Deseja Excluir?")
		@ 14,45 PROMPT " SIM "
		@ 14,53 PROMPT " NAO "
		MENU TO VOP
		DO CASE 
			CASE VOP=1
				DELE
				SKIP-1
				SET CURSO OFF
			ENDCASE
		RESTORE SCREEN FROM VTELA_DEL
		KEYBOARD CHR(1)
		VRET = 2	
	ELSE
		IF  LASTKEY()=13 .OR. LASTKEY()=27
			VRET = 0
		ELSE
			VRET = 1
		ENDIF		
	ENDIF
RETURN VRET
**************
FUNCTION SHOW
**************
SAVE SCREEN TO VTELA_PESQCLITESTE
PRIVATE VCAMPOS[2],VCAB[2]
	SET KEY -2 TO 
	VKEY = ""
	KEYBOARD CHR(1)
	USE PRODUTO INDEX PRODUTOB INDEX PRODUTOA
	VCAMPOS[1] = "DESCRICAO"
	VCAMPOS[2] = "CODPROD"
	
	VCAB[1] = "Descricao"
	VCAB[2] = "Codigo" 

	@ 04,10 CLEAR TO 16,75
	@ 04,10 TO 17,76 DOUBLE

	@ 06,11 TO 06,75 DOUBLE
	VCORES = SETCOLOR()
	SET COLOR TO N/W
		@ 05,11 SAY SPACE(65)
		@ 05,11 SAY UPPER(VKEY)
	SET COLOR TO N*/W
		@ 05,11+LEN(VKEY) SAY "Ü"
	SET COLOR TO W+/RB,N/W
	CENTRA(04,10,75,'[ Tecle "DELETE" Para Excluir ]') 
	CENTRA(17,10,75,"[ Pesquisa de Produto ]")
	DBEDIT(7,11,16,75,VCAMPOS,"BUSCA_P",0,VCAB)
	SET COLOR TO &VCORES
	IF LASTKEY() # 27
		VCODIGO = CODPROD
*		KEYBOARD CHR(13)C
	ELSE
		VCODIGO = SPACE(5)
	ENDIF
	SET CURSO ON
RESTORE SCREEN FROM VTELA_PESQCLITESTE
RETURN VCODIGO

FUNCTION BUSCA_P						&& pula para letra

	PARAMETERS VMODO,VCAMPO
	PRIVATE VRET
	VRET = 2	
	IF VMODO=4 &&AND. LASTKEY()>31 .AND. LASTKEY()<128 .OR. LASTKEY()=8 
		IF LASTKEY() = 7
			@ 12,40 CLEAR TO 15,65
			@ 12,40 TO 15,65
			CENTRA(13,40,65,"Deseja Excluir?")
			@ 14,45 PROMPT " SIM "
			@ 14,53 PROMPT " NAO "
			MENU TO VOP
			DO CASE 
				CASE VOP=1
					DELE
					SKIP -1
					SET CURSO OFF
				ENDCASE
			KEYBOARD CHR(1)
			VRET = 2	
			SEEK LEFT(VKEY,LEN(VKEY)-1)
		ENDIF
		IF LASTKEY()>31 .AND. LASTKEY()<128 .OR. LASTKEY()=8 	
			TECLA = LASTKEY()
			IF TECLA = 8 .OR. TECLA = 19
				VKEY = LEFT(VKEY,LEN(VKEY)-1)
			ELSE
				VKEY = VKEY + CHR(TECLA)
			ENDIF
			SET SOFTSEEK ON
			SEEK UPPER(VKEY)
			SET SOFTSEEK OFF
			SET COLOR TO N/W
				@ 05,11 SAY SPACE(65)
				@ 05,11 SAY UPPER(VKEY)
			SET COLOR TO N*/W
				@ 05,11+LEN(VKEY) SAY "Ü"
			SET COLOR TO W+/RB,N/W
			VRET = 2
		ENDIF
	ELSE
		IF  LASTKEY()=13 .OR. LASTKEY()=27
			VRET = 0
		ELSE
			VRET = 1
		ENDIF		
	ENDIF
IF LASTKEY() = 5 .OR. LASTKEY() = 24
	VKEY = ALLTRIM(DESCRICAO)
	SET COLOR TO N/W
	@ 05,11 SAY SPACE(65)
	@ 05,11 SAY UPPER(VKEY)
	SET COLOR TO N*/W
	@ 05,11+LEN(VKEY) SAY "Ü"
	SET COLOR TO W+/RB,N/W
ENDIF
IF LASTKEY() = 19
	VKEY = ""
	SET COLOR TO N/W
		@ 05,11 SAY SPACE(65)
		@ 05,11 SAY UPPER(VKEY)
	SET COLOR TO N*/W
		@ 05,11+LEN(VKEY) SAY "Ü"
	SET COLOR TO W+/RB,N/W
ENDIF	
RETURN VRET
**************
PROCEDURE SAIR
**************
SAVE SCREEN TO VTELA_SAIR
@ 12,20 CLEAR TO 15,55
@ 12,20 TO 15,60 DOUBLE
CENTRA(12,20,60,"[ O QUE DESEJA FAZER ? ]")
@ 14,21 SAY "( ) Sair do Sistema "
@ 13,21 SAY "( ) Efetuar Logoff de " + VNOME_U
VSAIR = MENU_O(13,2,22,CHR(7),0)
IF VSAIR = 2
	SET COLOR TO
	USE CONFIG
	REPLACE FIM WITH .T.
	CLOSE ALL
	SWPRUNCMD("MODE CO80",0,0)
	CANCEL
ELSEIF VSAIR = 1
	CLEAR ALL
	CLEAR
	USE CONFIG
	REPLACE FIM WITH .T.
	CLOSE ALL
	DO VIDEO
ENDIF
RESTORE SCREEN FROM VTELA_SAIR
RETURN

FUNCTION T_PRINT
VRE = .T.
IF .NOT. ISPRINTER() .AND. LASTKEY() # 27
	BOX("Impressora desligada.")
	DO WHILE INKEY()#27 .AND. .NOT. ISPRINTER()
	ENDDO
	IF LASTKEY() = 27
		VRE = .F.
	ELSE
		VRE = .T.
	ENDIF
ENDIF 
RETURN VRE
FUNCTION BoxMenu_A
	PARAMETERS VCONTOP,VOPCOES,VMSG,VLIN,VCOL,VLIMPA
	PRIVATE VOPCAO,VLINM
   VLINM = IIF(VLIN+VCONTOP<24,VLIN+VCONTOP,VLIMPA)
   @ VLIN,VCOL TO VLINM+1,VCOL+VLIMPA+1
	KEYBOARD CHR(31)
   VOPCAO = ACHOICE (VLIN+1,VCOL+1,VLINM,VCOL+VLIMPA,VOPCOES,.T.,"OPMSG")
	RETURN VOPCAO

***************
FUNCTION MENU_O
***************
PARAMETERS VCOL,VMENU,VINICIO,VCHR,VLOCAL
PRIVATE VOP
VLOCALAV = VCOL
IF VLOCAL <> 0
	VOP = VLOCAL
ELSE
	VOP = 1
ENDIF
VCOL = VCOL + VLOCAL
SET CURSO OFF
DO WHILE .T.
	SAVE SCREEN TO VTELA_A
		@ VCOL,VINICIO SAY VCHR
		INKEY(0)
	RESTORE SCREEN FROM VTELA_A
	IF LASTKEY() = 27 
		VOP = 0
		EXIT
	ENDIF
	IF LASTKEY() = 13
		EXIT
	ENDIF
	IF LASTKEY() = 5
		IF VOP > 1
			VOP = VOP -1
			VCOL = VCOL - 1
		ENDIF
	ENDIF
	IF LASTKEY() = 24
		IF VOP < VMENU
			VOP = VOP + 1
			VCOL = VCOL + 1
		ENDIF
	ENDIF
ENDDO
@ VCOL,VINICIO SAY VCHR
SET CURSO ON
RETURN VOP
*************
PROCEDURE LOC
*************
SAVE SCREEN TO VTELA_A_A
PRIVATE VCAMPOS[3],VCAB[3]
	SET KEY -2 TO 
	VKEY = ""
	KEYBOARD CHR(1)

	USE LOCACAO INDEX LOCACAOD
	GO TOP
	VCAMPOS[1] = "NOME"
	VCAMPOS[2] = "CODCLI"
	VCAMPOS[3] = "LANCA"
	
	VCAB[1] = "Nome"
	VCAB[2] = "Codigo" 
	VCAB[3] = "Lan‡amento"

	@ 06,10 CLEAR TO 16,75
	@ 06,10 TO 17,76 DOUBLE

	DBEDIT(7,11,16,75,VCAMPOS,0,0,VCAB)

	IF LASTKEY() # 27
		VCODIGO = SPACE(6) &&CODCLI
		KEYBOARD CHR(13)
		VLANC = LANCA
		KEYBOARD CHR(13)
	ENDIF
	SET CURSO ON
	SET KEY -2 TO LOC
RESTORE SCREEN FROM VTELA_A_A
RETURN
*************
FUNCTION NAO
*************
	MSGBOX("[ Acesso negando! ]")
RETURN .T.

****************
FUNCTION SIMNAO
****************
PARAMETERS VINICIO,VFIM,MESA,VSIMPLE

@ VINICIO,VFIM CLEAR TO VINICIO+3,VFIM+25
IF VSIMPLE = .T.
	@ VINICIO,VFIM TO VINICIO+3,VFIM+25 DOUBLE
ELSE
	@ VINICIO,VFIM TO VINICIO+3,VFIM+25
ENDIF
CENTRA(VINICIO+1,VFIM,VFIM+25,ALLTRIM(MESA))
@ VINICIO+2,VFIM+5 PROMPT " SIM "
@ VINICIO+2,VFIM+13 PROMPT " NAO "
MENU TO VOP

RETURN VOP
FUNCTION CONFIG
SAVE SCREEN TO VTELA_CONFIG
USE CONFIG
	VDIAS = DIAS
	VINICIO = INICIO
	@ 15,20 CLEAR TO 17,60
	@ 15,20 TO 17,60 DOUBLE
	@ 16,21 SAY "Dias " GET VDIAS 
	@ 16,40 SAY "Inicio " GET VINICIO
	READ
	IF LASTKEY() # 27
		REPLACE DIAS WITH VDIAS
		REPLACE INICIO WITH VINICIO
	ENDIF
RETURN .T.
*************
PROCEDURE VER
*************
	SWPRUNCMD("VOL > TRAVA",0,"","")
	ARQTRAVA= FOPEN("TRAVA")
	PIRATA = FREADSTR(ARQTRAVA, 82)
	PIRATA = ALLTRIM(PIRATA)
	PIRATA = SUBSTR(PIRATA, -11, 09)
	FCLOSE(ARQTRAVA)
	SWPRUNCMD("DEL TRAVA",0,"","")
	USE CONFIG
	GO TOP
	VHD=HD
	IF VHD=SPACE(9)
		REPLACE HD WITH PIRATA
	ELSE
		IF VHD<>PIRATA
			SAVE SCREEN TO VA
			SET COLOR TO W+/B
			CLEAR
			@ 00,00 TO 23,79 DOUBLE
	*		SET COLOR TO R*+/B
	*		@ 00,00 SAY REPLICATE(" COPIA NAO AUTORIZANDA ",150)
			SAVE SCREEN TO VTEALP		
			SET COLOR TO GR+/W
			@ 09,11 SAY SPACE(59)
			@ 09,11 SAY"Erro ?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨?¨"
			SET COLOR TO W/N
			@ 10,12 CLEAR TO 17,70
			SET COLOR TO GR+/R
			@ 10,11 CLEAR TO 16,69
			SET COLOR TO GR+*/R
			CENTRA(11,00,80,"Copia Nao Autorizada")
			SET COLOR TO GR+/R
			CENTRA(12,00,80,"Para Mairoes Infomacoes Ligue Para")
			CENTRA(13,00,80,"9946-6100 (c) Cleber de Almeida Sores")
			CENTRA(14,00,80,"Obrigando ! ! !")
		   @ 24,00 SAY SPACE(80)
			CENTRA(24,00,80,'"ESC" OU "ENTER" OU "F3"  =   SAIR')
			@ 16,12 SAY REPLICATE(CHR(7),57)
	*      TONE(700, 2)
	 *     TONE(900, 5)
			Y = 12
			p = 1
			A = 16
			SET CURSO OFF
			DO WHILE LASTKEY()#13 .AND. LASTKEY()#27 .AND. LASTKEY()#-2
				SAVE SCREEN TO VTELA
				@ 16,Y SAY CHR(A)
				INKEY(0.1)
				RESTORE SCREEN FROM VTELA
				IF P = 1 
					Y = Y + 1
						A=16
					IF Y = 69
						P = 2
					ENDIF
				ENDIF
				IF P = 2 
   				Y = Y - 1
						  A =17
		   		 IF Y = 12 
				        P = 1
					ENDIF
				ENDIF
			ENDDO
			?  ""
			SET COLOR TO 
			RESTORE SCREEN FROM VA
			? ""
			? ""
			? ""
			? ""
			? ""
			? ""
			? ""
			? ""
			SET CURSO ON
			CANCEL
		ENDIF
	ENDIF
	USE CONFIG
	VINICIO = INICIO+DIAS
	IF DATE()>=VINICIO
		SET COLOR TO W*/N
		? "ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»"
		? "º                                 Final de Tempo                             º"
		? "º   Para Mairos Informa‡äes Ligar Para Cleber de almeida soares 9946-6100    º"
		? "º                   Todos os Direitor de Copia esta Reservado a              º"
		? "º                           Cleber de Almeida Soares                         º"
		? "ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼"
		SET COLOR TO 
		SET CURSO ON
		CANCEL
	ENDIF

**********************
FUNCTION MOSTRAJOGO
**********************
SAVE SCREEN TO VTELA_TIP
PRIVATE VCAMPOS[2],VCAB[2]
	SET KEY -1 TO
	USE CJOGO INDEX CJOGOA
	KEYBOARD CHR(1)

	VCAMPOS[1] = "NOMEJOGO"
	VCAMPOS[2] = "CODJOGO"

	VCAB[1] = "Nome"
	VCAB[2] = "Codigo"

	@ 06,10 CLEAR TO 16,75
	@ 06,10 TO 17,76 DOUBLE

	CENTRA(06,10,75,'[ Tecle "DELETE" Para Excluir ]') 
	CENTRA(17,10,75,"[ Pesquisa de Jogos ]")
	DBEDIT(7,11,16,75,VCAMPOS,"BUSCA_T",0,VCAB)
	IF LASTKEY()#27
		VJOGOCOD = CODJOGO
*		KEYBOARD CHR(13)
	ELSE
		VJOGOCOD = "    "
	ENDIF				
	SET CURSO ON
SET KEY -1 TO MOSTRACLASSE
RESTORE SCREEN FROM VTELA_TIP
RETURN VJOGOCOD
*********************
FUNCTION PESQCONTAS
*********************
SAVE SCREEN TO VTELA_PESQCONT
@ 10,08 CLEAR TO 16,42
@ 10,08 TO 16,42 DOUBLE
@ 12,10 PROMPT "Pesquisar em Contas a Pagar   "
@ 14,10 PROMPT "Pesquisar em Contas a Receber "
MENU TO VOPCAOPESQ
DO CASE 
	CASE VOPCAOPESQ = 0
		VRE = .F.
	CASE VOPCAOPESQ = 1
		VRE = .T.
		USE PAGAR INDEX PAGAR1
		VTEXTO = "[ Pesquisa de Contas a Receber ]"
	CASE VOPCAOPESQ = 2
		VRE = .T.
		USE RECEBER INDEX RECEBER1
		VTEXTO = "[ Pesquisa de Contas a Pagar ]"
ENDCASE
IF VOPCAOPESQ <> 0
	PRIVATE VCAMPOS[6],VCAB[6]
	VC_CORES = SETCOLOR()
	VKEY = ""
	KEYBOARD CHR(1)

	VCAMPOS[1] = "NOME"
	VCAMPOS[2] = "COD"
	VCAMPOS[3] = "VALOR"
	VCAMPOS[4] = "TIPODOC"
	VCAMPOS[5] = "DATAE"
	VCAMPOS[6] = "DATA" 

	IF VOPCAOPESQ = 1
		VCAB[1] = "Pagar para:"
	ELSEIF VOPCAOPESQ = 2
		VCAB[1] = "Receber de :"
	ENDIF		
	VCAB[2] = "Codigo"
	VCAB[3] = "Valor"
	VCAB[4] = "Motivo"
	VCAB[5] = "Data de EmisÆo"

	IF VOPCAOPESQ = 1
		VCAB[6] = "Data do Pagamento"
	ELSEIF VOPCAOPESQ = 2
		VCAB[6] = "Data de Receber"
	ENDIF
	@ 06,10 CLEAR TO 16,75
	@ 06,10 TO 17,76 DOUBLE

	CENTRA(04,10,75,'[ Tecle "DELETE" Para Excluir ]') 
	CENTRA(17,11,75,VTEXTO)
	DBEDIT(7,11,16,75,VCAMPOS,"BUSCA_T",0,VCAB)
	IF LASTKEY() # 27
		VCOD = COD
	ELSE
		VCOD = SPACE(4)
	ENDIF
	SET CURSO ON
ENDIF
RESTORE SCREEN FROM VTELA_PESQCONT
RETURN VRE
*******************
FUNCTION M_USUARIO
*******************
USE USUARIO INDEX USUARIOA
PRIVATE VN[LASTREC()],VMSG[LASTREC()],VCODIGO[LASTREC()],VMENUS
GO TOP
SAVE SCREEN TO VTELA_USUARIO_CONS
X = 1
DO WHILE !EOF()
	VN[X] = NOME_U
	VMSG[X] = ""
	VCODIGO[X] = COD_U
	X = X + 1
	SKIP
ENDDO
CENTRA(20,10,30,"[ Escolha o Usuario ]")
VOPCAO = BOXMENU(4,VN,VMSG,14,10,40)
IF VOPCAO = 0
	VOPCAO = 1
ENDIF
RESTORE SCREEN FROM VTELA_USUARIO_CONS
RETURN VCODIGO[VOPCAO]

PROCEDURE A_CAL
***************
* CALENDARIO  *
***************
AS=SETCOLOR()
PRIVATE VTELACALE
SET CENTURY ON

SAVE SCREEN TO VTELACALE

VDATA1=CTOD("01"+SUBSTR(DTOC(DATE()),3,8))
VLIN = 4
VCOL = 39
VCAL = DATE()
P_COR = SETCOLOR()
*SET COLOR TO W/RG
*SET CURSO OFF
VTRUE = .T.
VMENU = ""
VPA=0
VLINA = 0
VCOLA = 0
VCOLB = 0
VLINB = 0
DO WHILE .T. .AND. LASTKEY()#27
*		@ 23,00 SAY SPACE(80)
		DIA="1"
		VDATA2=VDATA1
		SSS=SETCOLOR()
		LINHA=1
		VLINHA=05
		VNOMEMES=MES(VDATA1)
		VPOS=POS(VDATA1)
		@ 01,37 CLEAR TO 22,75
		@ 01,37 TO 22,75 DOUBLE
		@ 02,50 SAY VNOMEMES+" /"+STR(YEAR(VDATA1))
		@ 03,38 SAY "DOM   SEG  TER  QUA   QUI SEX  SAB"	
		X=0	
		DO WHILE MONTH(VDATA2)=MONTH(VDATA1)
			@ VLINHA,VPOS SAY STRZERO(VAL(DIA),2)
			DIA = ALLTRIM(STR(VAL(DIA)+1))
			VDATA2=VDATA2+1
			VPOS=VPOS+5
			X=X+1
			IF VTRUE = .T.
				VCOLA=VPOS
				VLINA = VLINHA
				VCOL = VPOS-6
				VTRUE = .F.
			ENDIF
			IF VPOS>70
				VPOS=40
				VLINHA=VLINHA+3
	 		ENDIF
			VCOLB = VPOS
			VLINB = VLINHA
		ENDDO
		VLINA = VLINHA
		DO WHILE LASTKEY()#27
			SAVE SCREEN TO VTELA_CAL
				@ VLIN,VCOL TO VLIN+2,VCOL+3
				INKEY(0)
			RESTORE SCREEN FROM VTELA_CAL
			DO CASE
			CASE LASTKEY()=13
				EXIT
				CASE LASTKEY()=27
					EXIT
				CASE LASTKEY()=43
					VDATA1=VDATA1+35
					VTRUE = .T.
					EXIT
				CASE LASTKEY()=45
					VDATA1=VDATA1-28
					VTRUE = .T.
					EXIT
				CASE LASTKEY() = 24
					IF VLIN < 19
						VLIN = VLIN + 3	
					ENDIF
				CASE LASTKEY() = 5
					IF VLIN > 4
						VLIN = VLIN - 3
					ENDIF
				CASE LASTKEY() = 4
					IF VCOL < 69
						VCOL = VCOL + 5
					ENDIF
				CASE LASTKEY() = 19
					IF VCOL > 39
						VCOL = VCOL - 5
					ENDIF
			ENDCASE
		ENDDO
		VDATA1=CTOD("01"+SUBSTR(DTOC(VDATA1),3,8))
ENDDO
*SET COLOR TO &P_COR
*SET CURSO ON
RESTORE SCREEN FROM VTELACALE
RETURN