*******************************************
* VID32.PRG RELAROTIO DE PRODUTO COMPLETO *
*******************************************
SAVE SCREEN TO VTELA_PROD
SAVE SCREEN TO VTELA_IMP
	VI = SIMNAO(11,40,"Enviar Para impressora ?",.F.) 
RESTORE SCREEN FROM VTELA_IMP
	BOX("Aguarde !!!")
IF VI <> 0
	IF VI = 1
		SET PRINT TO
		DO T_PRINT
	ELSEIF VI = 2
		SET PRINTER TO VIDEO
	ENDIF
	SET DEVICE TO PRINT
	IF LASTKEY() # 27
		USE PRODUTO INDEX PRODUTOB
		PAPA = LASTREC()
		CENTRA(00,00,60,VCABE1)
		CENTRA(01,00,60,VCABE2)
		CENTRA(02,00,60,VCABE3)
		X = 4
		Y  = 1
		DO WHILE .T.
			IF Y = PAPA+1
				EXIT
			ENDIF
			USE PRODUTO INDEX PRODUTOA INDEX PRODUTOB
			OY = STRZERO(Y,5)
			SEEK OY
			IF !EOF()
				VDESCRICAO = DESCRICAO
				VTIPO = STRZERO(VAL(TIPO),2)
				VCLASSE = STRZERO(VAL(CLASSE),2)
				VCODPROD = CODPROD
				@ X,00 SAY VDESCRICAO + "  " + VCODPROD
				X = X + 1
				@ X,00 SAY "Classe " + VCLASSE
				VARQ = ALIAS()
				USE CLASSE INDEX CLASSEA
				SEEK VCLASSE
				IF EOF()
					VNOMECLAS = "CLASSE INDEFINIDA"
				ELSE
					VNOMECLAS = NOMECLAS
				ENDIF
				@ X,15 SAY VNOMECLAS
				USE TIPO INDEX TIPOA
				SEEK VTIPO
				IF EOF()
					VVALORTIPO = 0
				ELSE
					VVALORTIPO = VALORTIPO
				ENDIF
				X = X + 1
				@ X,00 SAY "Tipo " +VTIPO
				@ X,10 SAY "Valor"
				@ X,18 SAY VVALORTIPO
				X = X + 1
				@ X,00 SAY REPLICATE("=",60)
				X = X +2
			ENDIF	
			Y = Y + 1
		ENDDO
		CENTRA(Y,00,60,VRODA1)
		Y = Y + 1
		CENTRA(Y,00,60,VRODA2)
		Y = Y + 1
		CENTRA(Y,00,60,VRODA3)
		@ Y+32,00 SAY "" 
		SET DEVICE TO SCREEN 
		VCORES = SETCOLOR()
		SET COLOR TO W/N
		SWPRUNCMD("BROWSE VIDEO.PRN",0,"","")					
		SET COLOR TO &VCORES
	ENDIF
ENDIF
SET DEVICE TO SCREEN 
RESTORE SCREEN FROM VTELA_PROD
RETURN