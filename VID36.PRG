******************************************
* VID36.PRG PESQUISA DE PRODUTO / CLASSE *
******************************************
PRIVATE VTELA,VCAMPOS[5],VCAB[5],VCOND,VCOND1,VCOND2
SAVE SCREEN TO VTELA

DO WHILE .T.

	@ 05,03 CLEAR TO 23,77
	
	VCHAVE=SPACE(02)
	
	@ 10,10 SAY "Informe Classe: " GET VCHAVE PICTURE "@!" 
	READ
	IF LASTKEY() = 27
		EXIT
	ENDIF
	IF VCHAVE = SPACE(02)
		VCHAVE = MOSTRACLASSE()
	ENDIF	
	VCHAVE = STRZERO(VAL(VCHAVE),2)
	USE CLASSE INDEX CLASSEA
	SEEK VCHAVE
	IF EOF()
		MSGBOX("Classe NÆo Encontrada!")
		LOOP
	ENDIF
	VNOMECLAS = NOMECLAS
	@ 10,35 SAY VNOMECLAS
	@ 10,10 SAY "Informe Classe:  " +  VCHAVE 
	IF LASTKEY()#27
	   VCOND = "VCHAVE = STRZERO(VAL(CLASSE),2)"
		IF .NOT. EMPTY(VCHAVE)
			BOX("Aguade um Momento!!")
			USE PRODUTO INDEX PRODUTOB
			COPY TO LOCTEMP FOR &VCOND
			USE LOCTEMP
			IF EOF()
				MSGBOX("Classe nao encontrado")
				USE
				EXIT
			ENDIF
				
		ENDIF	

		VCAMPOS[1] = "DESCRICAO"
		VCAMPOS[2] = "Codigo"

		VCAB[1] = "Descricao"
		VCAB[2] = "Codigo" 

		@ 05,03 to 19,76 DOUBLE
		CENTRA(19,04,74,"[ " + STRZERO(LASTREC(),6)+ " ]")
		DBEDIT(6,4,18,75,VCAMPOS,0,0,VCAB)
		IF LASTKEY() = 27
			LOOP	
		ENDIF
		IF SIMNAO(19,35,"Deseja Imprimir ?",.F.) = 1
			T_PRINT()
			IF LASTKEY() # 27
				BOX("Imprimido...")
				SET DEVICE TO PRINT
*				SET PRINTER TO VIDEO
				CENTRA(00,00,60,VCABE1)
				CENTRA(01,00,60,VCABE2)
				CENTRA(02,00,60,VCABE3)
				@ 05,00 SAY REPLICATE("=",60)
				@ 06,02 SAY "Classe " + VCHAVE + "  " +		VNOMECLAS
				@ 07,00 SAY REPLICATE("=",60)
				VLINHA = 9
				GO TOP
				DO WHILE !EOF()
					@ VLINHA,02 SAY DESCRICAO
					@ VLINHA,44 SAY CODPROD
					SKIP
					VLINHA = VLINHA + 1
				ENDDO
				VLINHA = VLINHA + 2
				@ VLINHA,00 SAY REPLICATE("=",60)
				VLINHA = VLINHA + 1
				@ VLINHA,02 SAY "Total de Produto [" + STRZERO(LASTREC(),10) + " ]"
				VLINHA = VLINHA + 2
				CENTRA(VLINHA,00,60,VRODA1)
				VLINHA = VLINHA + 1
				CENTRA(VLINHA,00,60,VRODA2)
				VLINHA = VLINHA + 1
				CENTRA(VLINHA,00,60,VRODA2)
				VLINHA = VLINHA + 1
				@ VLINHA+33,00 SAY ""
				SET DEVICE TO SCREEN
			ENDIF
		ENDIF
	ENDIF
ENDDO

RESTORE SCREEN FROM VTELA

CLOSE DATABASES

RETURN