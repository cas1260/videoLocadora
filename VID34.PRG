****************************
* PRODUTO / TIPO VID34.PRG *
****************************
PRIVATE VTELA,VCAMPOS[3],VCAB[3],VCOND
SAVE SCREEN TO VTELA_T_P
DO WHILE .T.
	VCODTIPO = SPACE(02)
	VCHAVE = SPACE(40)
	@ 05,01 CLEAR TO 23,77
	@ 12,10 SAY "Atores " GET VCHAVE PICT "@!"
	CLEAR GETS
	VCOD = "  "
	@ 10,10 SAY "Tipo   " GET VCOD PICT "99"
	READ
	VCODTIPO = VCOD
	IF LASTKEY() = 27
		EXIT
	ENDIF
	IF VCODTIPO = SPACE(02)
		VCODTIO = MOSTRATIPO()
		CLOSE ALL
	ENDIF
	VCODTIPO = STRZERO(VAL(VCODTIPO),2)
	CLOSE ALL
	USE TIPO INDEX TIPOA
	SEEK VCODTIPO
	IF EOF()
		MSGBOX("Tipo n∆o Encontrado!")
	ELSE
		CLEAR GETS
		@ 10,10 SAY "Tipo    " +  VCODTIPO
		VNOMETIPO  = NOMETIPO
		@ 10,25 SAY "[ " + VNOMETIPO + " Valor..: " +STR(VALORTIPO)+ " ]"
		@ 12,10 SAY "Atores " GET VCHAVE PICT "@!"
		READ
		IF LASTKEY() = 27
			LOOP
		ENDIF
		CLOSE ALL
		@ 05,03 CLEAR TO 23,77
		VCOD = STRZERO(VAL(VCOD),2)
		VTIPO = STRZERO(VAL(VCODTIPO))
*      VCOND = "(ATORES = ALLTRIM(VCHAVE) .AND. VTIPO = VCODTIPO .OR. (' '+ALLTRIM(VCHAVE)+' ')$(' '+ALLTRIM(ATORES)+' ') .AND. VTIPO = VCODTIPO)"
		VCHAVE = UPPER(ALLTRIM(VCHAVE))
		VCOND = "(ATORES = ALLTRIM(VCHAVE) .OR. (' '+ALLTRIM(VCHAVE)+' ')$(' '+ALLTRIM(ATORES)+' ')) .AND. STRZERO(VAL(TIPO),2) = VCODTIPO"
		BOX("Aguarde um Momento Por Favor!")
		USE PRODUTO INDEX PRODUTOB INDEX PRODUTOA
		COPY TO LOCTEMP FOR &VCOND 
		USE LOCTEMP
		GO TOP
	   IF EOF()
			MSGBOX("Produto nao encontrado")
			USE
			EXIT
		ENDIF
	
		VCAMPOS[1] = "DESCRICAO"
		VCAMPOS[2] = "CODPROD"
		VCAMPOS[3] = "ATORES"

		VCAB[1] = "Descricao"
		VCAB[2] = "Codigo" 
		VCAB[3] = "Atores"

		@ 05,03 CLEAR TO 23,77
		@ 05,03 to 23,75 DOUBLE
		CENTRA(23,03,75,"[ " + STRZERO(LASTREC(),6) + " ]")
		DBEDIT(6,4,22,74,VCAMPOS,0,0,VCAB)
		IF LASTKEY() = 27
			LOOP
		ENDIF
		IF SIMNAO(20,35,"Deseja imprimir?",.F.) = 1
			T_PRINT()
			IF LASTKEY() # 27
				SET DEVICE TO PRINT
*				SET PRINTER TO VIDEO
				CENTRA(00,00,60,VCABE1)
				CENTRA(01,00,60,VCABE2)
				CENTRA(02,00,60,VCABE3)
				@ 05,00 SAY REPLICATE("=",60)
				@ 06,02 SAY "Tipo " + VCODTIPO + "  " + ALLTRIM(VNOMETIPO) + " Autor : " + VCHAVE
				@ 07,00 SAY REPLICATE("=",60)
				VLINHA = 9
				GO TOP
				DO WHILE !EOF()
					@ VLINHA,02 SAY DESCRICAO
					@ VLINHA,44 SAY CODPROD
					SKIP
					VLINHA = VLINHA + 1
				ENDDO
				VLINHA = VLINHA + 2
				@ VLINHA,00 SAY REPLICATE("=",60)
				VLINHA = VLINHA + 1
				@ VLINHA,02 SAY "Total de Produto [" + STRZERO(LASTREC(),10) + " ]"
				VLINHA = VLINHA + 2
				CENTRA(VLINHA,00,60,VRODA1)
				VLINHA = VLINHA + 1
				CENTRA(VLINHA,00,60,VRODA2)
				VLINHA = VLINHA + 1
				CENTRA(VLINHA,00,60,VRODA2)
				VLINHA = VLINHA + 1
				@ VLINHA+33,00 SAY ""
				SET DEVICE TO SCREEN
			ENDIF
		ENDIF
	ENDIF
ENDDO
RESTORE SCREEN FROM VTELA_T_P
RETURN