*************************************************
*					 VID13.PRG FECHA CAIXA				*
*************************************************
SAVE SCREEN TO VTELA_CAIXA
DO WHILE .T.
	IF VCAIXA = "N"
		NAO()
		EXIT
	ENDIF
   VDATA_INICIO = DATE()
   VD_FIM = DATE()
	@ 10,40 CLEAR TO 17,75
	@ 10,40 TO 18,75 DOUBLE
   @ 11,41 SAY "Inicio " GET VDATA_INICIO
   @ 11,60 SAY "Fim " GET VD_FIM
	@ 12,40 TO 12,74 DOUBLE
	@ 12,40 SAY "Ã"
	@ 12,75 SAY "π"
	@ 13,41 SAY "A Receber  : "
	@ 14,41 SAY "Recebida   : "
	@ 15,41 SAY "Jogo.......: "		
	@ 16,41 SAY "Valor Total: "
	READ
	IF LASTKEY() = 27
		EXIT
	ENDIF
	USE LOCATOT
	USE LOCACAO INDEX LOCACAOA INDEX LOCACAOB 
	IF LASTKEY()#27
		VARECEBER = 0
		VRECEBER = 0
		VJOGO = 0
		USE LOCACAO
		DO WHILE !EOF()
	      IF VDATA_INICIO<=DEVOLUCAO .AND. VD_FIM>=DEVOLUCAO
				VARECEBER = VARECEBER + VALOR
			ENDIF
			SKIP
		ENDDO
		USE LOCATOT
		DO WHILE !EOF()
        IF VDATA_INICIO<=DTPAGO .AND. VD_FIM>=DTPAGO
				VRECEBER = VRECEBER + VALOR
			ENDIF
			SKIP		
		ENDDO
		USE JOGOFIM
		GO TOP
		DO WHILE !EOF()
        IF VDATA_INICIO<= DATA .AND. VD_FIM>=DATA
				VJOGO = VJOGO + VALOR
			ENDIF
			SKIP		
		ENDDO
		@ 13,41 SAY "A Receber  : "
		@ 13,53 SAY VARECEBER PICT "999,999.99"
		@ 14,41 SAY "Recebida   : "
		@ 14,53 SAY VRECEBER PICT  "999,999.99"
		@ 15,41 SAY "Jogo.......: "		
		@ 15,53 SAY VJOGO PICT "999,999.99"
		@ 16,41 SAY "Valor Total: "
		@ 16,53 SAY VARECEBER + VRECEBER + VJOGO PICT "999,999.99"
		VRESP = "N"
		@ 17,41 SAY "Deseja Imprimir? " GET VRESP PICT "@!" VALID VRESP$"SN"
		READ
		IF VRESP = "S"
			SAVE SCREEN 
			T_PRINT()
			RESTORE SCREEN 
			IF LASTKEY()#27
				SET DEVICE TO PRINT
*				SET PRINTER TO VIDEO
				CENTRA(00,00,60,VCABE1)
				CENTRA(01,00,60,VCABE2)
				CENTRA(02,00,60,VCABE3)
				@ 03,00 SAY REPLICATE("=",60)
				@ 05,02 SAY "Data de Emis∆o..: " 
				@ 05,25 SAY DATE()
				@ 06,02 SAY "De : " 
            @ 06,09 SAY VDATA_INICIO
				@ 06,23 SAY "Ate : "
            @ 06,31 SAY VD_FIM
				@ 07,02 SAY "A Receber : "
				@ 07,15 SAY VARECEBER PICT "999,999.99"
				@ 08,02 SAY "Recebido..: "
				@ 08,15 SAY VRECEBER PICT "999,999.99"
				@ 09,02 SAY "Jogo......: "
				@ 09,15 SAY VJOGO PICT "999,999.99"
				@ 11,00 SAY REPLICATE("=",60)
				@ 12,02 SAY "Total...: "
				@ 12,15 SAY VARECEBER + VRECEBER + VJOGO PICT "999,999.99"
				CENTRA(14,00,60,VRODA1)
				CENTRA(15,00,60,VRODA2)
				CENTRA(16,00,60,VRODA2)
				@ 44,00 SAY "" 
				SET DEVICE TO SCREEN 			
			ENDIF
		ENDIF
	ENDIF
ENDDO
CLOSE DATABASES
RESTORE SCREEN FROM VTELA_CAIXA

RETURN		