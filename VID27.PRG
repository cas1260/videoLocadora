********************************************************
*	 CADASTRO DE CONTAS A RECEBER E APAGAR VID27.PRG	*
*******************************************************
SAVE SCREEN TO VTELA_CONTAS
DO WHILE .T.
	IF CONT_CONT_C = "N"
		NAO()
		EXIT
	ENDIF
	SET KEY -1 TO PESQCONTAS
	@ 05,01 CLEAR TO 23,75
	VCOD = SPACE(8)
	VNOME = SPACE(40)
	VDATAE = DATE()
	VDATA = DATE()
	VVALOR = 0
	VTIPODOC = SPACE(40)
   @ 07,05 SAY "Codigo " GET VCOD PICT "99999999"
 	@ 06,28 SAY "( ) A Pagar"
	@ 07,28 say "( ) A Receber"
	@ 09,05 SAY "[ F2 - Pesquisa ]"
	READ
	@ 09,05 SAY SPACE(20)
	SET KEY -1 TO
	IF LASTKEY() = 27
		EXIT
	ENDIF
	VMENU = MENU_O(06,2,29,CHR(7),0)
	IF LASTKEY() = 27
		LOOP
	ENDIF
	IF VMENU = 1
		USE PAGAR INDEX PAGAR1
	ELSEIF VMENU = 2
		USE RECEBER INDEX RECEBER1
	ENDIF
	IF VCOD = SPACE(4)
		GO TOP
		VCOD = "0000"
		DO WHILE .T.
			GO TOP
			VCOD = VAL(VCOD) + 1
			VCOD = STRZERO(VCOD,8)
			SEEK VCOD
			IF EOF()
				EXIT
			ENDIF
		ENDDO
	ENDIF
	VCOD = STRZERO(VAL(VCOD),8)
	GO TOP
	SEEK VCOD
	IF EOF()
		VNOME = SPACE(40)
		VDATAE = DATE()
		VDATA = DATE()
		VVALOR = 0
		VTIPODOC = SPACE(40)
		VGRAVA = .T.
		VPAGOU = "NAO"
	ELSE
		VNOME = NOME
		VDATAE = DATAE
		VDATA = DATA
		VVALOR = VALOR
		VTIPODOC = TIPODOC
		VGRAVA = .F.
		VPAGOU = SIMNAO
	ENDIF
   @ 07,05 SAY "Codigo " GET VCOD PICT "99999999"
	CLEAR GETS
	IF VMENU = 1
		@ 09,05 SAY "Pagar Para     : " GET VNOME PICT "@!"
	ELSE
		@ 09,05 SAY "Receber de     : " GET VNOME PICT "@!"
	ENDIF
	@ 11,05 SAY "Motivo         : " GET VTIPODOC PICT "@!"
	@ 13,05 SAY "Data de Emis∆o : " GET VDATAE
	IF VMENU = 1
		@ 15,05 SAY "Data a Pagar   : " GET VDATA
	ELSE
		@ 15,05 SAY "Data a Receber : " GET VDATA
	ENDIF
	@ 17,05 say "Valor          : " GET VVALOR PICT "999,999.99"
	READ	
	IF LASTKEY() # 27
		IF VMENU = 1
			USE PAGAR INDEX PAGAR1
		ELSEIF VMENU = 2
			USE RECEBER INDEX RECEBER1
		ENDIF
		IF VGRAVA = .T.
			APPEND BLANK
		ENDIF
		REPLACE NOME WITH VNOME
		REPLACE TIPODOC WITH VTIPODOC
		REPLACE VALOR WITH VVALOR
		REPLACE COD WITH VCOD
		REPLACE DATA WITH VDATA
		REPLACE DATAE WITH VDATAE
		REPLACE MENU WITH VMENU
		IF VGRAVA = .T.
			IF VPAGOU <> "SIM"
				REPLACE SIMNAO WITH "N«O"
			ENDIF
		ENDIF
	ENDIF
ENDDO
RESTORE SCREEN FROM VTELA_CONTAS
RETURN