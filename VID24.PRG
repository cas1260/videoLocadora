***********************************************************
*					 CADASTRO DE TIPO VID24.PRG 					 *
***********************************************************
SAVE SCREEN TO VTELA_TIPO
DO WHILE .T.
	IF VTIPO = "N"
		NAO()
		EXIT
	ENDIF
	VNOMETIPO = SPACE(20)
	VCODTIPO = SPACE(2)
	VVALORTIPO = 0
	@ 15,02 CLEAR TO 18,55
	@ 15,02 TO 18,55 DOUBLE
	CENTRA(15,02,55,"[ F2 - PESQUISAR ]")
	@ 16,03 SAY "Codigo "
	@ 17,06 GET VCODTIPO PICT "@!"
	@ 16,12 SAY "Nome "
	@ 17,12 GET VNOMETIPO PICT "@!"
	@ 16,42 SAY "Valor "
	@ 17,42 GET  VVALORTIPO PICT "999,999.99"
	CLEAR GETS
	SET KEY -1 TO MOSTRATIPO
	@ 16,03 SAY "Codigo "
	@ 17,06 GET VCODTIPO PICT "@!"
	READ
	SET KEY -1 TO
	IF LASTKEY() = 27
		EXIT
	ENDIF
	USE TIPO INDEX TIPOA
	VCODTIPO = STRZERO(VAL(VCODTIPO),2)
	GO TOP
	SEEK VCODTIPO
	IF EOF()
		VNOMETIPO = SPACE(20)
*		VCODTIPO = SPACE(2)
		VVALORTIPO = 0
		VGRAVA = .T.
	ELSE
		VNOMETIPO = NOMETIPO
		VCODTIPO = CODTIPO
		VVALORTIPO = VALORTIPO
		VGRAVA = .F.
	ENDIF
	@ 15,02 CLEAR TO 18,55
	@ 15,02 TO 18,55 DOUBLE
	@ 16,03 SAY "Codigo "
	@ 17,06 SAY VCODTIPO PICT "@!"
	@ 16,12 SAY "Nome "
	@ 17,12 GET VNOMETIPO PICT "@!"
	@ 16,42 SAY "Valor "
	@ 17,42 GET  VVALORTIPO PICT "999,999.99"
	READ
	IF LASTKEY()#27
		IF VGRAVA = .T.
			APPEND BLANK
		ENDIF
		REPLACE NOMETIPO WITH VNOMETIPO
		REPLACE CODTIPO WITH VCODTIPO
		REPLACE VALORTIPO WITH VVALORTIPO
	ENDIF
ENDDO
RESTORE SCREEN FROM VTELA_TIPO
RETURN